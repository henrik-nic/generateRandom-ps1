# ------------------------------------------
# ğŸ“‚ File paths
# ------------------------------------------

$sourceCsv = "\Path\to\your\file.csv"
$outputCsv = "\Path\to\your\outputfolder\file.csv"

# ------------------------------------------
# ğŸ“¥ Load existing data
# ------------------------------------------

if (!(Test-Path $sourceCsv)) {
    Write-Error "âŒ Source file not found: $sourceCsv"
    exit
}

$people = Import-Csv -Path $sourceCsv

# ------------------------------------------
# ğŸ“¤ Extract desired fields
# ------------------------------------------

$accounts = foreach ($person in $people) {
    [PSCustomObject]@{
        SSN  = $person.SSN
        Namn = $person.Namn
        Mail = $person.Mail
        Guid = $person.Guid
    }
}

# ------------------------------------------
# ğŸ’¾ Save to CSV
# ------------------------------------------

$accounts | Export-Csv -Path $outputCsv -NoTypeInformation -Encoding UTF8
Write-Host "`nâœ… File saved to: $outputCsv"
