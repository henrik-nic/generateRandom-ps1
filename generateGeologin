# ------------------------------------------
# ğŸ“‚ File paths
# ------------------------------------------

$sourceCsv = "\path\to\your\source\file.csv"  # Update this path to your source CSV file
$outputCsv = "\path\to\your\output\file.csv"  # Update this path to your desired output CSV file

# ------------------------------------------
# ğŸ“¥ Load existing data
# ------------------------------------------

if (!(Test-Path $sourceCsv)) {
    Write-Error "âŒ Source file not found: $sourceCsv"
    exit
}

$people = Import-Csv -Path $sourceCsv

# ------------------------------------------
# ğŸ“¤ Extract desired fields
# ------------------------------------------

$accounts = foreach ($person in $people) {
    [PSCustomObject]@{
        IP   = $person.IP
        Guid = $person.Guid
    }
}

# ------------------------------------------
# ğŸ’¾ Save to CSV
# ------------------------------------------

$accounts | Export-Csv -Path $outputCsv -NoTypeInformation -Encoding UTF8
Write-Host "`nâœ… File saved to: $outputCsv"
