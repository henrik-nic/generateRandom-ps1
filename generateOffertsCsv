# Paths
$csvPath = "path\to\sellers.csv"  # Update this path to your sellers CSV file
$outputFolder = "\path\to\output\offers"  # Update this path to your desired output folder
New-Item -ItemType Directory -Path $outputFolder -Force | Out-Null

# Load sellers 
$sellers = Import-Csv -Path $csvPath -Encoding UTF8 | Select-Object -First 5000

# Company name generation
$prefixes = @("Nordic", "Tech", "Svenska", "Global", "Bright", "Future", "Prime", "Blue", "Green", "Silver", "Digital", "NextGen", "Smart", "Innovative", "Elite", "Advanced", "Pro", "Vision", "Dynamic", "Synergy")
$words = @("Enterprises", "Solutions", "Group", "Partners", "Dynamics", "Networks", "Technologies", "Systems", "Consulting", "Services", "Development", "Design", "Analytics", "Support", "Management", "Innovations", "Resources", "Labs", "Works", "Hub")
$suffixes = @("AB", "HB", "KB", "Ekonomisk F√∂rening", "Stiftelse", "Aktiebolag", "Handelsbolag", "Kommanditbolag", "Enskild Firma", "Ideell F√∂rening")

function Get-RandomCompany {
    "{0} {1} {2}" -f (Get-Random $prefixes), (Get-Random $words), (Get-Random $suffixes)
}

# Service catalog
$services = @(
    [PSCustomObject]@{Name="Systemintegration"; Price=7500},
    [PSCustomObject]@{Name="Molntj√§nster"; Price=9000},
    [PSCustomObject]@{Name="UX-design"; Price=6800},
    [PSCustomObject]@{Name="Backend-utveckling"; Price=8200},
    [PSCustomObject]@{Name="IT-konsulttj√§nst"; Price=7600},
    [PSCustomObject]@{Name="S√§kerhetsanalys"; Price=9900},
    [PSCustomObject]@{Name="Drift√∂vervakning"; Price=5600}
)

# Generate 50 offers
for ($i = 1; $i -le 5000; $i++) {
    $seller = Get-Random $sellers
    $customer = Get-RandomCompany
    $offerId = ([guid]::NewGuid().ToString().Substring(0, 8)).ToUpper()
    $date = Get-Date -Format "yyyy-MM-dd"
    $customerSafe = ($customer -replace '[\\\/:\*\?"<>\|]', '') -replace '\s+', '_'

    # Pick 3 random services
    $selected = $services | Get-Random -Count 3

    # Calculate total price
    $totalPrice = ($selected | Measure-Object -Property Price -Sum).Sum

    # Build CSV content for services
    $csvContent = $selected | ForEach-Object {
        [PSCustomObject]@{
            OffertNr = $offerId
            Datum = $date
            KundF√∂retag = $customer
            S√§ljare = $seller.Namn
            Epost = $seller.Mail
            Tj√§nst = $_.Name
            Pris_SEK = $_.Price
        }
    }

    # Add total row
    $totalRow = [PSCustomObject]@{
        OffertNr = $offerId
        Datum = $date
        KundF√∂retag = $customer
        S√§ljare = $seller.Namn
        Epost = $seller.Mail
        Tj√§nst = "Total"
        Pris_SEK = $totalPrice
    }

    $csvContent += $totalRow

    $csvFilePath = Join-Path $outputFolder "Offert_${customerSafe}_${offerId}.csv"
    $csvContent | Export-Csv -Path $csvFilePath -NoTypeInformation -Encoding UTF8

    Write-Host "üíæ [$i/50] Offert sparad som: $csvFilePath"
}
